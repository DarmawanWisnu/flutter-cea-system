@startuml
title Activity Diagram - Monitor Screen

|User|
start
:Akses halaman Monitor Screen;

|Sistem|
:Inisialisasi koneksi MQTT;
:Subscribe ke topic "kit/+/telemetry";
:Subscribe ke topic "kit/+/status";
:Load auto mode state dari Backend API;
:Menampilkan nilai sensor real-time;
:(pH, PPM, Temperature, Humidity, Water Level, Water Temp);
:Menampilkan status Kit dan mode kontrol (Auto / Manual);

|User|
:Melihat data sensor pada dashboard;
:Memilih mode kontrol (Auto / Manual);

|Sistem|
:Simpan preferensi mode ke Backend API;

if ("Mode Manual dipilih?") then (Ya)
  |Sistem|
  :Menampilkan tombol kontrol manual;
  :(pH Up, pH Down, Nutrient A, Nutrient B, Refill);

  |User|
  if ("User menekan tombol kontrol?") then (Ya)
    :Publish perintah ke MQTT Broker;
    :Topic: "kit/{kitId}/control";
  endif

  |Sistem|
  :Menjalankan perintah dari user;
  :Update tampilan status aktuator;
else (Tidak - Mode Auto)
  |Sistem|
  :Backend menjalankan kontrol otomatis;
  :Berdasarkan threshold parameter;
  :Hasil kontrol dikirim via MQTT;
endif

|Sistem|
:Memperbarui status sensor secara real-time;
:Data dari MQTT stream;

stop
@enduml
