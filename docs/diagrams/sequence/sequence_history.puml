@startuml
scale 3
skinparam monochrome true
skinparam defaultFontSize 20
title Sequence Diagram - History

actor "User" as User
participant "History Screen" as Form
participant "ApiService" as API
participant "Backend REST API" as Backend

' === Awal ===
User -> Form : Membuka halaman history
activate Form
Form -> User : Menampilkan tampilan awal (loading)
deactivate Form

' === Load kit dari shared state ===
Form -> Form : Ambil kitId dari currentKitIdProvider

' === Permintaan data history ===
Form -> API : getTelemetryHistory(kitId, limit)
activate API

API -> Backend : GET /telemetry/history?deviceId={kitId}&limit=N
activate Backend
Backend -> Backend : Query data telemetry dari database
Backend --> API : List<Telemetry> JSON
deactivate Backend

API --> Form : List<Telemetry>
deactivate API

' === Tampilkan data ke user ===
activate Form
Form -> User : Menampilkan list data sensor (pH, PPM, Temp, dll)
deactivate Form

' === User filter data ===
User -> Form : Memilih filter waktu (1 jam / 6 jam / semua)
activate Form
Form -> Form : Filter data lokal berdasarkan waktu
Form -> User : Menampilkan data hasil filter
deactivate Form

' === User pilih tanggal ===
User -> Form : Memilih tanggal tertentu
activate Form

Form -> API : getTelemetryHistory(kitId, date)
activate API
API -> Backend : GET /telemetry/history?deviceId={kitId}&days=1
activate Backend
Backend --> API : List<Telemetry> untuk tanggal tersebut
deactivate Backend
API --> Form : List<Telemetry>
deactivate API

Form -> User : Menampilkan data untuk tanggal terpilih
deactivate Form

@enduml



